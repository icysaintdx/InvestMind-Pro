# 更新日志 (Changelog)

## [v1.2.0] - 2025-12-04 00:10

### 🆕 新增功能
#### 🔑 API 配置系统全面优化 ⭐
- **功能**: 重构 API 配置模态框，支持自动加载、真实测试和数据渠道管理。
- **位置**: `ApiConfig.vue` / `App.vue` / `server.py`
- **特点**:
    - **自动加载**: 打开模态框自动从后端加载配置，无需手动点击。
    - **真实测试**: 测试按钮调用真实 API，返回详细响应示例。
    - **滚动优化**: 状态栏和按钮固定，配置项可滚动，主页面滚动禁用。
    - **数据渠道**: 支持聚合数据、FinnHub、Tushare、AKShare 等数据源配置。
- **文件**: `ApiConfig.vue`, `App.vue`, `server.py`

#### 📊 顶部状态栏扩展 ⭐
- **功能**: 扩展顶部状态栏，分组显示 AI API 和数据渠道状态。
- **位置**: `App.vue`
- **特点**:
    - **分组显示**: API 和数据分组，使用分隔符区分。
    - **实时状态**: 显示各个服务的连接状态（已配置/未配置/错误）。
    - **悬停提示**: 鼠标悬停显示完整名称。
- **文件**: `App.vue`

#### ℹ️ Agent 说明优化
- **功能**: Agent 卡片的信息图标使用原生浏览器 tooltip。
- **位置**: `AgentCard.vue`
- **特点**:
    - **简单可靠**: 使用 HTML `title` 属性，无需复杂实现。
    - **悬停显示**: 鼠标悬停即显示，移开自动消失。
    - **详细说明**: 包含每个 Agent 的工作原理和专业范畴。
- **文件**: `AgentCard.vue`

### 🐛 Bug修复
#### 🔧 API 配置加载修复
- **问题**: 打开配置模态框时不显示已保存的配置。
- **原因**: 后端返回 "configured" 字符串而不是实际的 API Key。
- **修复**: 后端返回实际的 API Keys，前端正确加载和显示。
- **影响**: 所有 API 配置现在都能正确显示。
- **文件**: `server.py`, `ApiConfig.vue`

#### 📜 模态框滚动体验修复
- **问题**: 滚动配置项时，底部按钮也会滚动消失；主页面也会滚动。
- **原因**: 没有正确设置 flex 布局；没有禁用主页面滚动。
- **修复**: 
    - 状态栏和按钮使用 `flex-shrink: 0` 固定。
    - 打开模态框时设置 `body.style.overflow = 'hidden'`。
- **影响**: 模态框滚动体验完美，主页面不再干扰。
- **文件**: `ApiConfig.vue`

#### 🔑 数据渠道配置支持
- **问题**: FinnHub 和 Tushare 配置不显示，测试按钮无效。
- **原因**: 后端 `API_KEYS` 字典没有包含这些数据源。
- **修复**: 添加 `finnhub` 和 `tushare` 到 `API_KEYS`，支持环境变量读取。
- **影响**: 所有数据渠道现在都能正确配置和测试。
- **文件**: `server.py`

### 📚 文档更新
- [API配置与状态栏优化完成报告.md](docs/API配置与状态栏优化完成报告.md) ⭐
- [UI优化完成报告.md](docs/UI优化完成报告.md) ⭐
- [UI问题修复报告.md](docs/UI问题修复报告.md) ⭐

---

## [v1.1.0] - 2025-12-03 23:00

### 🆕 新增功能
#### 🤖 全流程拟真分析系统 ⭐
- **功能**: 重构了投资分析的全流程，引入了21个专业分工的智能体。
- **位置**: 前端 `AnalysisView.vue` / 后端 `server.py`
- **特点**:
    - **流水线协同**: 实现 Step 1.1 (情报) -> Step 1.2 (中观) -> Step 1.3 (深度) 的层级依赖执行。
    - **动态指令 (Dynamic Prompting)**: 后端支持接收前端注入的 `custom_instruction`，根据角色动态调整分析侧重点。
    - **智能回退**: 当后端数据源不可用时，自动切换至高保真模拟数据，确保演示流畅。
    - **去模板化**: 强制智能体不复述基础行情，直接输出专业结论。

#### 🧠 可视化思维链 (CoT) ⭐
- **功能**: 为不同角色的智能体定制了专属的思考步骤展示。
- **位置**: 前端 `AgentCard.vue`
- **特点**: 新闻分析师显示"爬取公告"，技术分析师显示"计算MACD"，增强专业感。

### 🐛 Bug修复
#### 🔌 数据源连接修复
- **问题**: 后端 API 连接不稳定导致分析中断。
- **修复**: 增加了数据验证层和模拟数据兜底机制。

### 📚 文档更新
- [前端重构完成报告.md](docs/前端重构完成报告.md) ⭐
