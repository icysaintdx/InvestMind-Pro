# 吐司提示系统 (Toast System)

**更新时间**: 2025-12-11 04:40  
**版本**: v1.7.2

---

## 🎯 功能概述

将项目中所有的 `alert()` 和 `confirm()` 弹窗替换为更优雅的吐司提示（Toast），提供更好的用户体验。

---

## 🆕 系统组成

### 1. Toast 组件 (`Toast.vue`)
- 位置：`src/components/Toast.vue`
- 功能：显示临时提示消息
- 特性：
  - 支持 4 种类型：success、error、warning、info
  - 自动隐藏（默认 3 秒）
  - 动画效果（fadeIn/fadeOut）
  - 响应式设计

### 2. Toast 服务 (`toast.js`)
- 位置：`src/utils/toast.js`
- 功能：提供全局 Toast API
- 方法：
  - `$toast.success(message, duration)`
  - `$toast.error(message, duration)`
  - `$toast.warning(message, duration)`
  - `$toast.info(message, duration)`
  - `$toast.show(options)`
  - `$toast.hide()`

### 3. 全局注册
- 在 `main.js` 中全局注册
- 可通过 `window.$toast` 访问
- 组件内通过 `this.$toast` 访问（Options API）

---

## 💻 使用方法

### 基本使用
```javascript
// 成功提示
window.$toast.success('操作成功！')

// 错误提示
window.$toast.error('操作失败，请重试')

// 警告提示
window.$toast.warning('请注意风险')

// 信息提示
window.$toast.info('这是一条提示信息')
```

### 自定义持续时间
```javascript
// 显示 5 秒
window.$toast.success('保存成功', 5000)

// 永久显示（需手动关闭）
window.$toast.error('严重错误', 0)
```

### 高级选项
```javascript
window.$toast.show({
  message: '自定义消息',
  type: 'success',
  duration: 4000
})
```

---

## 🔄 已替换的组件

| 组件 | 文件位置 | 替换数量 |
|------|----------|----------|
| ModelManager | `src/components/ModelManager.vue` | 3 |
| ApiConfig | `src/components/ApiConfig.vue` | 4 |
| AnalysisView | `src/views/AnalysisView.vue` | 8 |
| ReportExporter | `src/components/ReportExporter.vue` | 2 |
| HistoryView | `src/views/HistoryView.vue` | 4 |
| AgentConfigPanel | `src/components/AgentConfigPanel.vue` | 已有成功消息 |

### 特殊情况
- **PaperTrading**: 使用 Element Plus 的 ElMessage，保持原样
- **AgentConfigPanel**: 已实现自定义成功消息系统

---

## 🎨 样式设计

### 颜色主题
```css
/* 成功 - 绿色 */
.toast-success {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(15, 23, 42, 0.95));
  border-color: rgba(34, 197, 94, 0.3);
}

/* 错误 - 红色 */
.toast-error {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(15, 23, 42, 0.95));
  border-color: rgba(239, 68, 68, 0.3);
}

/* 警告 - 橙色 */
.toast-warning {
  background: linear-gradient(135deg, rgba(251, 146, 60, 0.1), rgba(15, 23, 42, 0.95));
  border-color: rgba(251, 146, 60, 0.3);
}

/* 信息 - 蓝色 */
.toast-info {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(15, 23, 42, 0.95));
  border-color: rgba(59, 130, 246, 0.3);
}
```

### 视觉效果
- 毛玻璃效果：`backdrop-filter: blur(10px)`
- 阴影效果：`box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3)`
- 渐变背景：深色主题适配
- 圆角边框：`border-radius: 8px`

---

## ⚡ 替换示例

### Before (使用 alert)
```javascript
alert('保存成功！')
alert(`错误：${error.message}`)
```

### After (使用 Toast)
```javascript
window.$toast && window.$toast.success('保存成功！')
window.$toast && window.$toast.error(`错误：${error.message}`)
```

### 安全调用
使用 `window.$toast &&` 确保 Toast 服务已加载：
```javascript
window.$toast && window.$toast.success('消息')
```

---

## 💡 最佳实践

### 1. 选择合适的类型
- **Success**: 操作成功完成
- **Error**: 操作失败或错误
- **Warning**: 需要用户注意的警告
- **Info**: 一般性信息提示

### 2. 设置合理的持续时间
- 简短消息：2-3 秒
- 普通消息：3-4 秒
- 重要消息：4-5 秒
- 错误消息：5 秒或更长

### 3. 消息文本
- 简洁明了
- 避免过长（最多 2-3 行）
- 使用友好的语言
- 包含必要的上下文

### 4. 避免滥用
- 不要同时显示多个 Toast
- 避免频繁显示
- 重要操作使用模态框确认

---

## 🔧 技术细节

### Vue 3 Composition API
```javascript
import { ref, computed } from 'vue'

export default {
  setup() {
    const visible = ref(false)
    const message = ref('')
    const type = ref('info')
    
    const show = (options) => {
      // 实现逻辑
    }
    
    return { visible, message, type, show }
  }
}
```

### 单例模式
确保全局只有一个 Toast 实例：
```javascript
let toastInstance = null

const initToast = () => {
  if (!toastInstance) {
    toastInstance = createApp(Toast).mount(mountNode)
  }
  return toastInstance
}
```

### 动画实现
使用 Vue 的 `<Transition>` 组件：
```html
<Transition name="toast-fade">
  <div v-if="visible" class="toast">
    <!-- 内容 -->
  </div>
</Transition>
```

---

## 🚀 未来改进

### 1. 多实例支持
支持同时显示多个 Toast 消息

### 2. 位置选项
- 顶部中间（当前）
- 顶部右侧
- 底部中间
- 底部右侧

### 3. 自定义图标
允许使用自定义图标或图片

### 4. 操作按钮
添加"撤销"、"重试"等操作按钮

### 5. 进度条
显示自动关闭的倒计时进度

### 6. 主题定制
支持亮色/暗色主题切换

---

## 📝 注意事项

1. **兼容性**: 确保 Toast 服务已加载再调用
2. **覆盖问题**: z-index 设为 9999 确保显示在最上层
3. **移动端**: 已适配移动端显示
4. **国际化**: 消息文本建议使用中文

---

**状态**: ✅ 已实施  
**影响**: 全局用户体验提升  
**维护**: 统一的提示系统便于维护
