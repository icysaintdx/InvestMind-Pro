# 🤖 AlphaCouncil 智能体架构总结

## 📊 当前架构状态

### 1. 智能体总数：约20个

融合后的AlphaCouncil系统共有**20个智能体**，分为两个体系：

#### 原InvestMind Pro体系（10个）
- **位置**：通过前端调用，后端简单处理
- **特点**：成熟的层级递进分析流程
- **优势**：UI完善，用户体验好

#### TradingAgents-CN体系（10个新增）
- **位置**：`backend/agents/`目录下的Python模块
- **特点**：完整的业务逻辑实现
- **优势**：功能强大，辩论机制完善

### 2. 架构差异对比

| 维度 | 原InvestMind Pro | TradingAgents-CN | 统一后 |
|-----|-----------------|------------------|--------|
| **实现方式** | 前端定义+LLM调用 | 后端Python类 | 混合模式 |
| **调用方式** | `/api/analyze` | 各自API端点 | 统一注册表 |
| **管理方式** | 分散管理 | 模块化管理 | 集中管理 |
| **扩展性** | 一般 | 良好 | 优秀 |

## 🏗️ 统一架构设计

### 智能体分层架构

```
第一阶段：数据分析（8个智能体）
├── 原系统（5个）
│   ├── 宏观政策分析师
│   ├── 行业轮动分析师
│   ├── 技术分析专家
│   ├── 资金流向分析师
│   └── 基本面估值分析师
└── 新增（3个）
    ├── 新闻舆情分析师
    ├── 社交媒体分析师
    └── 中国市场专家

第二阶段：研究整合（4个智能体）
├── 原系统（2个）
│   ├── 基本面研究总监
│   └── 市场动能总监
└── 新增（2个）
    ├── 看涨研究员（Bull）
    └── 看跌研究员（Bear）

第三阶段：风险评估（5个智能体）
├── 原系统（2个）
│   ├── 系统性风险总监
│   └── 组合风险总监
└── 新增（3个）
    ├── 激进风控师
    ├── 保守风控师
    └── 中立风控师

第四阶段：决策执行（3个智能体）
├── 原系统（1个）
│   └── 投资决策总经理
└── 新增（2个）
    ├── 风险经理
    └── 量化交易员
```

## ✅ 已完成的统一管理方案

### 1. 智能体注册表
**文件**：`backend/agents/agent_registry.py`
- 统一管理所有20个智能体
- 支持按类型、阶段、系统查询
- 提供依赖关系管理
- 支持动态激活/禁用

### 2. 统一API接口
**文件**：`backend/api/agents_api.py`
- `/api/agents/registry` - 获取完整注册表
- `/api/agents/list` - 智能体列表（支持筛选）
- `/api/agents/{id}` - 智能体详情
- `/api/agents/call` - 统一调用接口
- `/api/agents/workflow/stages` - 工作流阶段
- `/api/agents/statistics` - 统计信息

### 3. 关键特性
- **向后兼容**：原10个智能体继续通过`/api/analyze`工作
- **新功能集成**：新智能体通过模块化方式集成
- **统一管理**：所有智能体通过注册表统一管理
- **灵活扩展**：支持动态添加新智能体

## 📈 使用方式

### 1. 获取所有智能体信息
```python
GET /api/agents/registry

# 返回
{
  "total": 20,
  "legacy_count": 10,
  "new_count": 10,
  "by_stage": {...},
  "by_type": {...},
  "agents": {...}
}
```

### 2. 按条件筛选智能体
```python
GET /api/agents/list?type=analyst&stage=1&is_legacy=false

# 返回新系统的第一阶段分析师
```

### 3. 统一调用智能体
```python
POST /api/agents/call
{
  "agent_id": "news_analyst",
  "stock_code": "600519",
  "params": {...},
  "context": {...}
}
```

## 🎯 下一步计划

### 立即执行
1. 测试智能体注册表API
```bash
python backend/server.py
# 访问 http://localhost:8000/api/agents/registry
```

2. 更新前端调用方式
- 使用新的统一API获取智能体列表
- 动态展示所有20个智能体
- 支持新旧系统智能体混合调用

### 后续优化
1. **LLM对接**：为新智能体配置实际的语言模型
2. **依赖管理**：实现智能体间的自动依赖注入
3. **性能优化**：添加缓存和并发处理
4. **可视化**：创建智能体协作网络图

## 💡 架构优势

1. **统一管理**
   - 所有智能体集中注册
   - 统一的配置和调用接口
   - 便于监控和调试

2. **灵活扩展**
   - 支持动态添加智能体
   - 新旧系统无缝集成
   - 模块化设计易于维护

3. **高度可配置**
   - 智能体可动态激活/禁用
   - 支持依赖关系管理
   - 工作流阶段可调整

4. **向后兼容**
   - 原有功能100%保留
   - 前端无需大改动
   - 平滑升级路径

## 📝 总结

通过创建统一的智能体注册表和管理API，我们成功将原InvestMind Pro的10个智能体和TradingAgents-CN的10个新智能体整合到一个统一的框架中。现在系统拥有20个专业智能体，分为4个阶段协同工作，既保留了原系统的优势，又引入了新的辩论决策机制，实现了1+1>2的效果。

---

**架构状态**：✅ 统一管理方案已实现  
**智能体总数**：20个（10原有 + 10新增）  
**管理方式**：集中式注册表 + 统一API  
**下一步**：测试API并更新前端组件
