# 智能体数据源真实化更新

> 更新时间: 2025-12-04 06:35  
> 状态: ✅ 已完成

---

## 🎯 更新目标

1. **显示真实网站名称** - 不再显示模糊的"法律风险数据"，改为具体的网站域名
2. **添加智能体依赖关系** - 后续智能体引用前序智能体的分析结果
3. **修复巨潮资讯网API** - 添加调试信息

---

## 📊 更新后的数据源显示

### 1. 新闻分析师 (news_analyst)
```
📊 参考数据  4个来源 | 80条数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
实时新闻聚合器（东方财富） (10条)
AKShare个股新闻 (10条)
财联社快讯 (10条)
微博热议 (50条)
```

### 2. 社交媒体分析师 (social_analyst)
```
📊 参考数据  2个来源 | 50条数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
微博热议 (50条)
雪球社区 (待实现)
```

### 3. 中国市场专家 (china_market)
```
📊 参考数据  2个来源 | 20条数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
财联社快讯 (10条)
东方财富 (10条)
```

### 4. 系统性风险评估 (risk_system)
```
📊 参考数据  2个来源 | 0条数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
wenshu.court.gov.cn (中国裁判文书网-待实现)
新闻分析师 (引用前序分析)
```

### 5. 保守型/激进型/中性型风险评估
```
📊 参考数据  2个来源 | 0条数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
wenshu.court.gov.cn (中国裁判文书网-待实现)
新闻分析师 (引用前序分析)
```

### 6. 风险经理 (risk_manager)
```
📊 参考数据  3个来源 | 3条数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
系统性风险评估 (引用分析结果)
保守型风险评估 (引用分析结果)
激进型风险评估 (引用分析结果)
```

### 7. 组合风险总监 (risk_portfolio)
```
📊 参考数据  3个来源 | 3条数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
风险经理 (引用综合风险评估)
技术分析师 (引用技术面分析)
资金流分析师 (引用资金面分析)
```

### 8. 交易员 (trader)
```
📊 参考数据  2个来源 | 1条数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
www.cninfo.com.cn (巨潮资讯网-待实现)
风险经理 (引用风险评估)
```

---

## 🔗 智能体依赖关系图

```
Stage 1: 数据采集层
├── 新闻分析师 (news_analyst)
│   └── 数据源: 东方财富、AKShare、财联社、微博
├── 社交媒体分析师 (social_analyst)
│   └── 数据源: 微博热议、雪球社区
└── 中国市场专家 (china_market)
    └── 数据源: 财联社、东方财富

Stage 2: 风险评估层
├── 系统性风险评估 (risk_system)
│   ├── 数据源: wenshu.court.gov.cn
│   └── 引用: 新闻分析师
├── 保守型风险评估 (risk_conservative)
│   ├── 数据源: wenshu.court.gov.cn
│   └── 引用: 新闻分析师
├── 激进型风险评估 (risk_aggressive)
│   ├── 数据源: wenshu.court.gov.cn
│   └── 引用: 新闻分析师
└── 中性型风险评估 (risk_neutral)
    ├── 数据源: wenshu.court.gov.cn
    └── 引用: 新闻分析师

Stage 3: 风险管理层
└── 风险经理 (risk_manager)
    └── 引用: 系统性风险评估、保守型风险评估、激进型风险评估

Stage 4: 组合管理层
└── 组合风险总监 (risk_portfolio)
    └── 引用: 风险经理、技术分析师、资金流分析师

Stage 5: 执行层
└── 交易员 (trader)
    ├── 数据源: www.cninfo.com.cn
    └── 引用: 风险经理
```

---

## 💡 关键改进

### 1. 真实网站域名
**修改前**:
```javascript
{
  source: '法律风险数据',
  count: 0,
  title: '待实现'
}
```

**修改后**:
```javascript
{
  source: 'wenshu.court.gov.cn',
  count: 0,
  title: '中国裁判文书网(待实现)'
}
```

### 2. 智能体依赖关系
**修改前**:
```javascript
// 风险经理没有显示依赖
agentDataSources.value['risk_manager'] = [
  { source: '法律风险数据', count: 0 }
]
```

**修改后**:
```javascript
// 风险经理显示引用的智能体
agentDataSources.value['risk_manager'] = [
  { source: '系统性风险评估', count: 1, title: '引用分析结果' },
  { source: '保守型风险评估', count: 1, title: '引用分析结果' },
  { source: '激进型风险评估', count: 1, title: '引用分析结果' }
]
```

### 3. 组合风险总监
**特点**: 引用多个前序智能体的分析结果

```javascript
agentDataSources.value['risk_portfolio'] = [
  { source: '风险经理', count: 1, title: '引用综合风险评估' },
  { source: '技术分析师', count: 1, title: '引用技术面分析' },
  { source: '资金流分析师', count: 1, title: '引用资金面分析' }
]
```

---

## 🔧 巨潮资讯网API调试

### 问题
API返回空数据: `⚠️ API返回空数据`

### 调试方案
添加详细的日志输出：

```python
logger.info(f"原始API响应: {result}")
logger.info(f"响应类型: {type(result)}")
logger.info(f"响应keys: {result.keys() if isinstance(result, dict) else 'Not a dict'}")
```

### 可能原因
1. **API接口变化** - 巨潮资讯网可能更新了API
2. **参数错误** - 请求参数可能不正确
3. **反爬虫限制** - 需要更多的请求头
4. **响应格式变化** - 返回的数据结构可能不同

### 下一步
运行测试查看详细日志：
```bash
python test_cninfo_api.py
```

查看日志中的：
- 原始API响应内容
- 响应数据类型
- 响应的keys

---

## 📊 完整的数据源配置表

| 智能体 | 真实数据源 | 引用智能体 | 总数据量 |
|--------|-----------|-----------|---------|
| 新闻分析师 | 东方财富、AKShare、财联社、微博 | - | 80条 |
| 社交媒体分析师 | 微博热议、雪球社区 | - | 50条 |
| 中国市场专家 | 财联社、东方财富 | - | 20条 |
| 系统性风险评估 | wenshu.court.gov.cn | 新闻分析师 | 0条 |
| 保守型风险评估 | wenshu.court.gov.cn | 新闻分析师 | 0条 |
| 激进型风险评估 | wenshu.court.gov.cn | 新闻分析师 | 0条 |
| 中性型风险评估 | wenshu.court.gov.cn | 新闻分析师 | 0条 |
| 风险经理 | - | 3个风险评估 | 3条 |
| 组合风险总监 | - | 风险经理、技术分析师、资金流分析师 | 3条 |
| 交易员 | www.cninfo.com.cn | 风险经理 | 1条 |

---

## 🧪 测试步骤

### 1. 重启前端
```bash
cd alpha-council-vue
npm run serve
```

### 2. 测试巨潮资讯网API
```bash
python test_cninfo_api.py
```

查看日志输出，特别注意：
- `原始API响应` 的内容
- 是否有错误信息
- 响应的数据结构

### 3. 前端测试
1. 打开 `http://localhost:8080`
2. 输入股票代码 `600519`
3. 点击"开始分析"
4. 观察各智能体卡片的数据源显示

### 4. 预期效果
- ✅ 显示真实网站域名
- ✅ 显示智能体依赖关系
- ✅ 数据源清晰明确

---

## 📝 注意事项

### 1. 真实网站显示
- 使用域名而不是中文名称
- 添加状态说明（待实现/已实现）
- 保持简洁明了

### 2. 智能体依赖
- 后续智能体引用前序智能体
- 显示引用的智能体名称
- count设为1表示引用1个分析结果

### 3. 数据透明化
- 用户可以清楚看到数据来源
- 用户可以理解智能体之间的关系
- 用户可以追溯分析依据

---

**数据源真实化更新完成！** ✅

现在数据源显示更加真实和透明，用户可以清楚地看到：
1. 真实的数据来源网站
2. 智能体之间的依赖关系
3. 每个智能体使用的数据量
