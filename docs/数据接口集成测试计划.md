# æ•°æ®æ¥å£é›†æˆæµ‹è¯•ä¸è°ƒé€šè®¡åˆ’

> **ç›®æ ‡**: æµ‹è¯•å¹¶è°ƒé€šæ‰€æœ‰æ•°æ®è·å–è„šæœ¬ï¼Œç¡®ä¿èƒ½è·å–çœŸå®æ•°æ®å¹¶ä¼ é€’ç»™ LLM åˆ†æ
> **æ—¶é—´**: 2025-12-04 03:00 å¼€å§‹
> **çŠ¶æ€**: ğŸ”´ è¿›è¡Œä¸­

---

## ğŸ“‹ æ€»ä½“æ¶æ„

```
æ•°æ®è·å–å±‚ â†’ æ•°æ®éªŒè¯å±‚ â†’ æ•°æ®ç¼“å­˜å±‚ â†’ APIæ¥å£å±‚ â†’ å‰ç«¯æ™ºèƒ½ä½“ â†’ LLMåˆ†æ
```

---

## ğŸ¯ ç¬¬ä¸€é˜¶æ®µï¼šè‚¡ç¥¨æ•°æ®æ¥å£ï¼ˆå·²å®Œæˆ âœ…ï¼‰

### 1.1 æ•°æ®æºç®¡ç†å™¨
- **æ–‡ä»¶**: `backend/dataflows/data_source_manager.py`
- **çŠ¶æ€**: âœ… å·²å®Œæˆ
- **åŠŸèƒ½**:
  - AKShare æ•°æ®è·å–
  - æ–°æµªè´¢ç»æ•°æ®è·å–
  - èšåˆæ•°æ®è·å–
  - Tushare æ•°æ®è·å–
  - è‡ªåŠ¨é™çº§æœºåˆ¶
- **æµ‹è¯•**: âœ… å·²éªŒè¯ï¼Œèƒ½æ­£å¸¸è·å–è‚¡ç¥¨å®æ—¶æ•°æ®
- **API**: `/api/stock/{symbol}` âœ…

### 1.2 è‚¡ç¥¨æ•°æ®é€‚é…å™¨
- **æ–‡ä»¶**: `backend/dataflows/stock_data_adapter.py`
- **çŠ¶æ€**: âœ… å·²å®Œæˆ
- **åŠŸèƒ½**: ç»Ÿä¸€ä¸åŒæ•°æ®æºçš„è¿”å›æ ¼å¼
- **æµ‹è¯•**: âœ… å·²éªŒè¯

### 1.3 ç›¸å…³å·¥å…·è„šæœ¬
- `backend/dataflows/akshare_utils.py` - â³ å¾…æµ‹è¯•
- `backend/dataflows/tushare_utils.py` - â³ å¾…æµ‹è¯•
- `backend/dataflows/stock/stock_utils.py` - â³ å¾…æµ‹è¯•
- `backend/dataflows/stock/stock_validator.py` - â³ å¾…æµ‹è¯•

---

## ğŸ¯ ç¬¬äºŒé˜¶æ®µï¼šæ–°é—»èˆ†æƒ…æ¥å£ï¼ˆå¾…å®æ–½ ğŸ”´ï¼‰

### 2.1 æ–°é—»æ•°æ®è·å–

#### A. ä¸­å›½è´¢ç»æ–°é—»
- **æ–‡ä»¶**: `backend/dataflows/news/chinese_finance.py`
- **çŠ¶æ€**: â³ å¾…æµ‹è¯•
- **æ•°æ®æº**:
  - ä¸œæ–¹è´¢å¯Œ
  - æ–°æµªè´¢ç»
  - è´¢è”ç¤¾
  - è¯åˆ¸æ—¶æŠ¥
- **æµ‹è¯•æ­¥éª¤**:
  1. æµ‹è¯•å•ä¸ªæ•°æ®æºè¿æ¥
  2. æµ‹è¯•æ–°é—»æŠ“å–åŠŸèƒ½
  3. æµ‹è¯•æ•°æ®æ ¼å¼åŒ–
  4. éªŒè¯è¿”å›æ•°æ®å®Œæ•´æ€§

#### B. å®æ—¶æ–°é—»
- **æ–‡ä»¶**: `backend/dataflows/news/realtime_news.py`
- **çŠ¶æ€**: â³ å¾…æµ‹è¯•
- **åŠŸèƒ½**: å®æ—¶æ–°é—»é‡‡é›†å’Œæ›´æ–°
- **æµ‹è¯•æ­¥éª¤**:
  1. æµ‹è¯•å®æ—¶æ–°é—»æµ
  2. éªŒè¯æ›´æ–°é¢‘ç‡
  3. æµ‹è¯•æ•°æ®å»é‡

#### C. Google æ–°é—»
- **æ–‡ä»¶**: `backend/dataflows/news/google_news.py`
- **çŠ¶æ€**: â³ å¾…æµ‹è¯•
- **æ³¨æ„**: å¯èƒ½éœ€è¦ä»£ç†

#### D. ç»Ÿä¸€æ–°é—»å·¥å…·
- **æ–‡ä»¶**: `backend/dataflows/news/unified_news_tool.py`
- **çŠ¶æ€**: â³ å¾…æµ‹è¯•
- **åŠŸèƒ½**: æ•´åˆæ‰€æœ‰æ–°é—»æº
- **ä¼˜å…ˆçº§**: â­â­â­ æœ€é«˜

### 2.2 æ–°é—» API æ¥å£
- **æ–‡ä»¶**: `backend/api/news_api.py`
- **çŠ¶æ€**: âœ… ä»£ç å­˜åœ¨ï¼Œâ³ å¾…é›†æˆæµ‹è¯•
- **ç«¯ç‚¹**:
  - `POST /api/news/analyze` - æ–°é—»åˆ†æ
  - `GET /api/news/list` - æ–°é—»åˆ—è¡¨
  - `GET /api/news/realtime` - å®æ—¶æ–°é—»
  - `GET /api/news/sentiment` - æƒ…ç»ªåˆ†æ

### 2.3 æ–°é—»è¿‡æ»¤å’Œå¢å¼º
- `backend/dataflows/news/news_filter.py` - â³ å¾…æµ‹è¯•
- `backend/dataflows/news/enhanced_news_filter.py` - â³ å¾…æµ‹è¯•
- `backend/dataflows/news/news_filter_integration.py` - â³ å¾…æµ‹è¯•

---

## ğŸ¯ ç¬¬ä¸‰é˜¶æ®µï¼šç¤¾äº¤åª’ä½“æ•°æ®ï¼ˆå¾…å®æ–½ ğŸ”´ï¼‰

### 3.1 ç¤¾äº¤åª’ä½“çˆ¬è™«
- **æ–‡ä»¶**: `backend/dataflows/social_media_crawler.py`
- **çŠ¶æ€**: â³ å¾…æµ‹è¯•
- **æ•°æ®æº**:
  - é›ªçƒ
  - è‚¡å§
  - å¾®åšï¼ˆå¯é€‰ï¼‰

### 3.2 Reddit æ•°æ®
- **æ–‡ä»¶**: `backend/dataflows/reddit_utils.py`
- **çŠ¶æ€**: â³ å¾…æµ‹è¯•
- **æ³¨æ„**: éœ€è¦ Reddit API Key

### 3.3 ä¸­å›½å¸‚åœºçˆ¬è™«
- **æ–‡ä»¶**: `backend/dataflows/china_market_crawler.py`
- **çŠ¶æ€**: â³ å¾…æµ‹è¯•
- **åŠŸèƒ½**: çˆ¬å–ä¸­å›½å¸‚åœºç›¸å…³æ•°æ®

---

## ğŸ¯ ç¬¬å››é˜¶æ®µï¼šæŠ€æœ¯åˆ†ææ•°æ®ï¼ˆå¾…å®æ–½ ğŸ”´ï¼‰

### 4.1 Kçº¿æ•°æ®
- **éœ€æ±‚**: è·å–å†å²Kçº¿æ•°æ®ï¼ˆæ—¥çº¿ã€å‘¨çº¿ã€æœˆçº¿ï¼‰
- **æ•°æ®æº**: AKShare / Tushare
- **çŠ¶æ€**: â³ å¾…å®ç°

### 4.2 æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
- **æ–‡ä»¶**: `backend/dataflows/stockstats_utils.py`
- **çŠ¶æ€**: â³ å¾…æµ‹è¯•
- **æŒ‡æ ‡**:
  - MA (ç§»åŠ¨å¹³å‡çº¿)
  - MACD
  - KDJ
  - RSI
  - BOLL (å¸ƒæ—å¸¦)

### 4.3 èµ„é‡‘æµå‘
- **éœ€æ±‚**: è·å–ä¸»åŠ›èµ„é‡‘æµå‘æ•°æ®
- **æ•°æ®æº**: AKShare / ä¸œæ–¹è´¢å¯Œ
- **çŠ¶æ€**: â³ å¾…å®ç°

---

## ğŸ¯ ç¬¬äº”é˜¶æ®µï¼šæ•°æ®ç¼“å­˜å’Œç®¡ç†ï¼ˆå¾…ä¼˜åŒ– ğŸ”´ï¼‰

### 5.1 ç¼“å­˜ç®¡ç†å™¨
- `backend/dataflows/cache_manager.py` - â³ å¾…æµ‹è¯•
- `backend/dataflows/adaptive_cache.py` - â³ å¾…æµ‹è¯•
- `backend/dataflows/integrated_cache.py` - â³ å¾…æµ‹è¯•

### 5.2 æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
- `backend/dataflows/data_completeness_checker.py` - â³ å¾…æµ‹è¯•

---

## ğŸ¯ ç¬¬å…­é˜¶æ®µï¼šå‰ç«¯é›†æˆï¼ˆå¾…å®æ–½ ğŸ”´ï¼‰

### 6.1 æ™ºèƒ½ä½“æ•°æ®è·å–æµç¨‹

**ç°åœ¨çš„æµç¨‹ï¼ˆé”™è¯¯ï¼‰**:
```
æ™ºèƒ½ä½“ â†’ ç›´æ¥è°ƒç”¨ LLM â†’ å‡­ç©ºåˆ†æ
```

**åº”è¯¥çš„æµç¨‹ï¼ˆæ­£ç¡®ï¼‰**:
```
æ™ºèƒ½ä½“ â†’ è°ƒç”¨æ•°æ®æ¥å£ â†’ è·å–çœŸå®æ•°æ® â†’ ä¼ ç»™ LLM â†’ åŸºäºæ•°æ®åˆ†æ
```

### 6.2 éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶
- `alpha-council-vue/src/views/AnalysisView.vue`
  - ä¿®æ”¹ `runAgentAnalysis` å‡½æ•°
  - åœ¨è°ƒç”¨ LLM å‰å…ˆè·å–çœŸå®æ•°æ®

### 6.3 æ•°æ®ä¼ é€’æµç¨‹
```javascript
// 1. æ–°é—»åˆ†æå¸ˆ
const newsData = await fetch('/api/news/list?symbol=600519')
const newsAnalysis = await callLLM(newsData) // åŸºäºçœŸå®æ•°æ®åˆ†æ

// 2. ç¤¾äº¤åª’ä½“åˆ†æå¸ˆ
const socialData = await fetch('/api/social/sentiment?symbol=600519')
const socialAnalysis = await callLLM(socialData)

// 3. æŠ€æœ¯åˆ†æå¸ˆ
const technicalData = await fetch('/api/technical/kline?symbol=600519')
const technicalAnalysis = await callLLM(technicalData)
```

---

## ğŸ“Š æµ‹è¯•ä¼˜å…ˆçº§

### P0 - æœ€é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³æµ‹è¯•ï¼‰
1. âœ… è‚¡ç¥¨å®æ—¶æ•°æ®è·å– - `data_source_manager.py`
2. ğŸ”´ æ–°é—»æ•°æ®è·å– - `unified_news_tool.py`
3. ğŸ”´ ä¸­å›½è´¢ç»æ–°é—» - `chinese_finance.py`
4. ğŸ”´ æ–°é—» API é›†æˆæµ‹è¯•

### P1 - é«˜ä¼˜å…ˆçº§ï¼ˆæœ¬å‘¨å®Œæˆï¼‰
1. ğŸ”´ ç¤¾äº¤åª’ä½“æ•°æ®è·å– - `social_media_crawler.py`
2. ğŸ”´ Kçº¿æ•°æ®è·å–
3. ğŸ”´ æŠ€æœ¯æŒ‡æ ‡è®¡ç®— - `stockstats_utils.py`
4. ğŸ”´ å‰ç«¯æ™ºèƒ½ä½“é›†æˆ

### P2 - ä¸­ä¼˜å…ˆçº§ï¼ˆä¸‹å‘¨å®Œæˆï¼‰
1. ğŸ”´ æ•°æ®ç¼“å­˜ä¼˜åŒ–
2. ğŸ”´ æ•°æ®å®Œæ•´æ€§éªŒè¯
3. ğŸ”´ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

---

## ğŸ”§ æµ‹è¯•è„šæœ¬æ¨¡æ¿

### æµ‹è¯•æ–°é—»æ¥å£
```python
# test_news_api.py
import asyncio
from backend.dataflows.news.unified_news_tool import create_unified_news_tool

async def test_news():
    tool = create_unified_news_tool()
    news = await tool.get_news("600519", days_back=3)
    print(f"è·å–åˆ° {len(news)} æ¡æ–°é—»")
    for item in news[:5]:
        print(f"- {item['title']} ({item['source']})")

asyncio.run(test_news())
```

### æµ‹è¯•è‚¡ç¥¨æ•°æ®
```python
# test_stock_data.py
from backend.dataflows.data_source_manager import DataSourceManager

def test_stock():
    manager = DataSourceManager()
    data = manager.get_stock_data("600519")
    print(data)

test_stock()
```

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œï¼ˆä»Šå¤©ï¼‰
1. **æµ‹è¯•æ–°é—»æ¥å£** - éªŒè¯èƒ½å¦è·å–æ–°é—»æ•°æ®
2. **æµ‹è¯•ç¤¾äº¤åª’ä½“æ¥å£** - éªŒè¯èƒ½å¦è·å–èˆ†æƒ…æ•°æ®
3. **åˆ›å»ºæµ‹è¯•è„šæœ¬** - ä¸ºæ¯ä¸ªæ¥å£åˆ›å»ºç‹¬ç«‹æµ‹è¯•

### æœ¬å‘¨å®Œæˆ
1. **ä¿®å¤æ‰€æœ‰æ•°æ®è·å–æ¥å£**
2. **é›†æˆåˆ°å‰ç«¯æ™ºèƒ½ä½“**
3. **éªŒè¯æ•°æ®æµå®Œæ•´æ€§**

### ä¸‹å‘¨å®Œæˆ
1. **ä¼˜åŒ–æ•°æ®ç¼“å­˜**
2. **å®Œå–„é”™è¯¯å¤„ç†**
3. **æ€§èƒ½ä¼˜åŒ–**

---

## âœ… éªŒæ”¶æ ‡å‡†

### æ•°æ®è·å–å±‚
- [ ] èƒ½è·å–è‚¡ç¥¨å®æ—¶æ•°æ®
- [ ] èƒ½è·å–æ–°é—»æ•°æ®ï¼ˆè‡³å°‘3æ¡ï¼‰
- [ ] èƒ½è·å–ç¤¾äº¤åª’ä½“æ•°æ®
- [ ] èƒ½è·å–Kçº¿æ•°æ®
- [ ] æ‰€æœ‰æ¥å£æœ‰é”™è¯¯å¤„ç†

### API æ¥å£å±‚
- [ ] `/api/news/list` è¿”å›çœŸå®æ–°é—»
- [ ] `/api/social/sentiment` è¿”å›çœŸå®èˆ†æƒ…
- [ ] `/api/technical/kline` è¿”å›çœŸå®Kçº¿
- [ ] æ‰€æœ‰æ¥å£å“åº”æ—¶é—´ < 3ç§’

### å‰ç«¯é›†æˆ
- [ ] æ•°æ®é€æ˜åŒ–é¢æ¿æ˜¾ç¤ºçœŸå®æ•°æ®æµ
- [ ] æ™ºèƒ½ä½“åŸºäºçœŸå®æ•°æ®åˆ†æ
- [ ] æ–°é—»èˆ†æƒ…é¢æ¿æ˜¾ç¤ºçœŸå®æ–°é—»
- [ ] ç”¨æˆ·èƒ½çœ‹åˆ°å®Œæ•´çš„æ•°æ®è·å–è¿‡ç¨‹

---

## ğŸš¨ å½“å‰é—®é¢˜

1. **æ–°é—»æ¥å£æœªæµ‹è¯•** - ä¸çŸ¥é“èƒ½å¦æ­£å¸¸å·¥ä½œ
2. **ç¤¾äº¤åª’ä½“æ¥å£æœªæµ‹è¯•** - ä¸çŸ¥é“èƒ½å¦æ­£å¸¸å·¥ä½œ
3. **å‰ç«¯æœªé›†æˆ** - æ™ºèƒ½ä½“æ²¡æœ‰è°ƒç”¨æ•°æ®æ¥å£
4. **æ•°æ®æµä¸é€æ˜** - ç”¨æˆ·çœ‹ä¸åˆ°æ•°æ®è·å–è¿‡ç¨‹

---

## ğŸ’¡ å»ºè®®

**ç«‹å³å¼€å§‹æµ‹è¯•æ–°é—»æ¥å£ï¼**

åˆ›å»ºæµ‹è¯•è„šæœ¬ `test_all_data_sources.py`ï¼Œé€ä¸ªæµ‹è¯•æ‰€æœ‰æ•°æ®æºï¼Œè®°å½•å“ªäº›èƒ½ç”¨ï¼Œå“ªäº›éœ€è¦ä¿®å¤ã€‚

ç„¶åæŒ‰ä¼˜å…ˆçº§é€ä¸ªä¿®å¤å’Œé›†æˆã€‚
